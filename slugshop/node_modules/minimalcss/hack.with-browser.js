const minimalcss = require('./index')
const puppeteer = require('puppeteer')
console.log(minimalcss.version)
;(async () => {
  const browser = await puppeteer.launch({})

  await minimalcss
    .minimize({
      urls: ['https://news.ycombinator.com'],
      browser: browser
      // puppeteerArgs: ['--no-sandbox', '--disable-setuid-sandbox']
    })
    .then(result => {
      // res.set('Content-Type', 'application/json')
      // // res.send('{"message":"Hello from the custom server!"}');
      // res.send(
      //   JSON.stringify({
      //     finalCss: result.finalCss
      //     // XXX include stats and verbose information
      //   })
      // )
      console.log('OUTPUT', result.finalCss.length, result.finalCss)
    })
    .catch(error => {
      // res.set('Content-Type', 'application/json')
      // res.send('{"message":"Hello from the custom server!"}');
      console.error(`Failed the minimize CSS: ${error}`)
      // res.send(
      //   JSON.stringify({
      //     error: error.toString()
      //   })
      // )
      // console.error(`Failed the minimize CSS: ${error}`)
    })
})()

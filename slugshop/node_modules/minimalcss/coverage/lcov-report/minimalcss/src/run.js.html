<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for minimalcss/src/run.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">All files</a> / <a href="index.html">minimalcss/src</a> run.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">54.91% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>95/173</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">48.51% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>49/101</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">33.33% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>9/27</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">55.23% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>95/172</span>
      </div>
    </div>
  </div>
  <div class='status-line medium'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">79x</span>
<span class="cline-any cline-yes">79x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">79x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">78x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-yes">61x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">59x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">57x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">57x</span>
<span class="cline-any cline-yes">57x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">56x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-yes">52x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-yes">489x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">'use strict'
&nbsp;
const puppeteer = require('puppeteer')
// @ts-ignore
const csso = require('csso')
// @ts-ignore
const csstree = require('css-tree')
const cheerio = require('cheerio')
const utils = require('./utils')
const url = require('url')
&nbsp;
/**
 * Take in a csstree AST, mutate it and return a csstree AST.
 * The mutation is about:
 *
 *   1) Remove all keyframe declarations that are *not* mentioned
 *      by animation name.
 *   2) Remove all font-face declarations that are *not* mentioned
 *      as the font-family.
 *
 * The gist of the function is that it walks the AST, populates sets
 * that track the names of all animations and font families. Then,
 * it converts the AST to a plain object, which it mutates by filtering
 * the 'children' object.
 * Lastly it uses the csstree's fromPlainObject to return the plain
 * object back as an AST.
 * @param {Object} ast
 * @return Object
 */
const postProcessOptimize = <span class="fstat-no" title="function not covered" >as</span>t =&gt; {
  // First walk the AST to know which animations are ever mentioned
  // by the remaining rules.
  const activeAnimationNames = <span class="cstat-no" title="statement not covered" >new Set(</span>
    csstree.lexer
      .findAllFragments(ast, 'Type', 'keyframes-name')
      .map(<span class="fstat-no" title="function not covered" >en</span>try =&gt; <span class="cstat-no" title="statement not covered" >csstree.generate(entry.nodes.first()))</span>
  )
&nbsp;
  // This is the function we use to filter @keyframes atrules out,
  // if its name is not actively used.
  // It also filters out all `@media print` atrules.
<span class="cstat-no" title="statement not covered" >  csstree.walk(ast, {</span>
    visit: 'Atrule',
    enter: <span class="fstat-no" title="function not covered" >(n</span>ode, item, list) =&gt; {
      const basename = <span class="cstat-no" title="statement not covered" >csstree.keyword(node.name).basename</span>
<span class="cstat-no" title="statement not covered" >      if (basename === 'keyframes') {</span>
<span class="cstat-no" title="statement not covered" >        if (!activeAnimationNames.has(csstree.generate(node.prelude))) {</span>
<span class="cstat-no" title="statement not covered" >          list.remove(item)</span>
        }
      } else <span class="cstat-no" title="statement not covered" >if (basename === 'media') {</span>
<span class="cstat-no" title="statement not covered" >        if (csstree.generate(node.prelude) === 'print') {</span>
<span class="cstat-no" title="statement not covered" >          list.remove(item)</span>
        }
      }
    }
  })
&nbsp;
  // Now figure out what font-families are at all used in the AST.
  const activeFontFamilyNames = <span class="cstat-no" title="statement not covered" >new Set()</span>
<span class="cstat-no" title="statement not covered" >  csstree.walk(ast, {</span>
    visit: 'Declaration',
    enter: <span class="fstat-no" title="function not covered" >fu</span>nction(node) {
      // walker pass through `font-family` declarations inside @font-face too
      // this condition filter them, to walk through declarations
      // inside a rules only.
<span class="cstat-no" title="statement not covered" >      if (this.rule) {</span>
<span class="cstat-no" title="statement not covered" >        csstree.lexer</span>
          .findDeclarationValueFragments(node, 'Type', 'family-name')
          .forEach(<span class="fstat-no" title="function not covered" >en</span>try =&gt; {
            const name = <span class="cstat-no" title="statement not covered" >utils.unquoteString(</span>
              csstree.generate({
                type: 'Value',
                children: entry.nodes
              })
            )
<span class="cstat-no" title="statement not covered" >            activeFontFamilyNames.add(name)</span>
          })
      }
    }
  })
&nbsp;
  // Walk into every font-family rule and inspect if we uses its declarations
<span class="cstat-no" title="statement not covered" >  csstree.walk(ast, {</span>
    visit: 'Atrule',
    enter: <span class="fstat-no" title="function not covered" >(a</span>trule, atruleItem, atruleList) =&gt; {
<span class="cstat-no" title="statement not covered" >      if (csstree.keyword(atrule.name).basename === 'font-face') {</span>
        // We're inside a font-face rule! Let's dig deeper.
<span class="cstat-no" title="statement not covered" >        csstree.walk(atrule, {</span>
          visit: 'Declaration',
          enter: <span class="fstat-no" title="function not covered" >de</span>claration =&gt; {
<span class="cstat-no" title="statement not covered" >            if (csstree.property(declaration.property).name === 'font-family') {</span>
              const name = <span class="cstat-no" title="statement not covered" >utils.unquoteString(</span>
                csstree.generate(declaration.value)
              )
              // was this @font-face used?
<span class="cstat-no" title="statement not covered" >              if (!activeFontFamilyNames.has(name)) {</span>
<span class="cstat-no" title="statement not covered" >                atruleList.remove(atruleItem)</span>
              }
            }
          }
        })
      }
    }
  })
}
&nbsp;
const processPage = ({
  page,
  options,
  pageUrl,
  stylesheetAsts,
  stylesheetContents,
  doms,
  allHrefs,
  redirectResponses,
  skippedUrls
}) =&gt;
  new Promise(async (resolve, reject) =&gt; {
    // If anything goes wrong, for example a `pageerror` event or
    // a bad download request (e.g. !response.ok), then remember that
    // we have fulfilled the promise and don't want to call `reject` or `resolve`
    // a second time.
    let fulfilledPromise = false
&nbsp;
    const safeReject = error =&gt; {
      <span class="missing-if-branch" title="else path not taken" >E</span>if (!fulfilledPromise) {
        reject(error)
      }
    }
&nbsp;
    const debug = options.debug || false
    const loadimages = options.loadimages || false
    const withoutjavascript = options.withoutjavascript || false
&nbsp;
    try {
      <span class="missing-if-branch" title="if path not taken" >I</span>if (options.userAgent) {
<span class="cstat-no" title="statement not covered" >        await page.setUserAgent(options.userAgent)</span>
      }
&nbsp;
      <span class="missing-if-branch" title="if path not taken" >I</span>if (options.viewport) {
<span class="cstat-no" title="statement not covered" >        await page.setViewport(options.viewport)</span>
      }
&nbsp;
      // A must or else you can't do console.log from within page.evaluate()
      page.on('console', <span class="fstat-no" title="function not covered" >ms</span>g =&gt; {
<span class="cstat-no" title="statement not covered" >        if (debug) {</span>
          // console.log(...(msg.args))
          // console.log(msg.args)
<span class="cstat-no" title="statement not covered" >          for (let i = 0; i &lt; msg.args.length; ++i) {</span>
<span class="cstat-no" title="statement not covered" >            console.log(`${i}: ${msg.args[i]}`)</span>
          }
        }
      })
&nbsp;
      await page.setRequestInterception(true)
      page.on('request', request =&gt; {
        const requestUrl = request.url()
        <span class="missing-if-branch" title="if path not taken" >I</span>if (/data:image\//.test(requestUrl)) {
          // don't need to download those
<span class="cstat-no" title="statement not covered" >          request.abort()</span>
        } else if (
          !loadimages &amp;&amp;
          /\.(png|jpg|jpeg|gif|webp)$/.test(requestUrl.split('?')[0])
        ) {
          request.abort()
        } else if (stylesheetAsts[requestUrl]) {
          // no point downloading this again
          request.abort()
        } else if (options.skippable &amp;&amp; options.skippable(request)) {
          // If the URL of the request that got skipped is a CSS file
          // not having it in stylesheetAsts is going to cause a
          // problem later when we loop through all &lt;link ref="stylesheet"&gt;
          // tags.
          // So put in an empty (but not falsy!) object for this URL.
          skippedUrls.add(requestUrl)
          request.abort()
        } else {
          request.continue()
        }
      })
&nbsp;
      // To build up a map of all downloaded CSS
      page.on('response', response =&gt; {
        const responseUrl = response.url()
&nbsp;
        const ct = response.headers()['content-type'] || ''
        if (response.status() &gt;= 400) {
          return safeReject(new Error(`${response.status()} on ${responseUrl}`))
        } else if (response.status() &gt;= 300) {
          // If the 'Location' header points to a relative URL,
          // convert it to an absolute URL.
          // If it already was an absolute URL, it stays like that.
          const redirectsTo = new URL(
            response.headers().location,
            responseUrl
          ).toString()
          redirectResponses[responseUrl] = redirectsTo
        } else if (
          ct.indexOf('text/css') &gt; -1 ||
          /\.css$/i.test(responseUrl.split('?')[0])
        ) {
          response.text().then(text =&gt; {
            const ast = csstree.parse(text)
            csstree.walk(ast, node =&gt; {
              if (node.type === 'Url') {
                let value = node.value
                let path = value.value
                if (value.type !== 'Raw') {
                  path = path.substr(1, path.length - 2)
                }
                const sameHost =
                  url.parse(responseUrl).host === url.parse(pageUrl).host
                if (/^https?:\/\/|^\/\//i.test(path)) {
                  // do nothing
                } else <span class="missing-if-branch" title="if path not taken" >I</span>if (/^\//.test(path) &amp;&amp; <span class="branch-1 cbranch-no" title="branch not covered" >sameHost)</span> {
                  // do nothing
                } else {
                  const resolved = new url.URL(path, responseUrl)
                  if (sameHost) {
                    path = resolved.pathname
                  } else {
                    path = resolved.href
                  }
                }
                if (value.type !== 'Raw') {
                  value.value = `"${path}"`
                } else {
                  value.value = path
                }
              }
            })
            stylesheetAsts[responseUrl] = ast
            stylesheetContents[responseUrl] = text
          })
        }
      })
&nbsp;
      page.on('pageerror', error =&gt; {
        safeReject(error)
      })
&nbsp;
      let response
&nbsp;
      <span class="missing-if-branch" title="else path not taken" >E</span>if (!withoutjavascript) {
        // First, go to the page with JavaScript disabled.
        await page.setJavaScriptEnabled(false)
        response = await page.goto(pageUrl)
        <span class="missing-if-branch" title="if path not taken" >I</span>if (!response.ok()) {
<span class="cstat-no" title="statement not covered" >          return safeReject(new Error(`${response.status()} on ${pageUrl}`))</span>
        }
        const htmlVanilla = await page.content()
        doms.push(cheerio.load(htmlVanilla))
        await page.setJavaScriptEnabled(true)
      }
&nbsp;
      // XXX There is another use case *between* the pure DOM (without any
      // javascript) and after the network is idle.
      // For example, any CSSOM that is *made by javascript* but goes away
      // after all XHR is finished loading.
      // What we can do is do that lookup here using...
      //    response = await page.goto(pageUrl, {
      //        waitUntil: ['domcontentloaded']
      //    })
      // And add that to the list of DOMs.
      // This will slow down the whole processing marginally.
&nbsp;
      // Second, goto the page and evaluate it on the 'networkidle2' event.
      // This gives the page a chance to load any &lt;script defer src="..."&gt;
      // and even some JS that does XHR requests right after load.
      response = await page.goto(pageUrl, {
        waitUntil: ['domcontentloaded', 'networkidle0']
      })
      <span class="missing-if-branch" title="if path not taken" >I</span>if (!response.ok()) {
<span class="cstat-no" title="statement not covered" >        return safeReject(</span>
          new Error(`${response.status()} on ${pageUrl} (second time)`)
        )
      }
      const evalNetworkIdle = await page.evaluate(<span class="fstat-no" title="function not covered" >()</span> =&gt; {
        // The reason for NOT using a Set here is that that might not be
        // supported in ES5.
        const hrefs = <span class="cstat-no" title="statement not covered" >[]</span>
        // Loop over all the 'link' elements in the document and
        // for each, collect the URL of all the ones we're going to assess.
<span class="cstat-no" title="statement not covered" >        Array.from(document.querySelectorAll('link')).forEach(<span class="fstat-no" title="function not covered" >li</span>nk =&gt; {</span>
<span class="cstat-no" title="statement not covered" >          if (</span>
            link.href &amp;&amp;
            (link.rel === 'stylesheet' ||
              link.href.toLowerCase().endsWith('.css')) &amp;&amp;
            !link.href.toLowerCase().startsWith('blob:') &amp;&amp;
            link.media !== 'print'
          ) {
            // if (!stylesheetAsts[link.href]) {
            //   throw new Error(`${link.href} not in stylesheetAsts!`)
            // }
            // if (!Object.keys(stylesheetAsts[link.href]).length) {
            //   // If the 'stylesheetAsts[link.href]' thing is an
            //   // empty object, simply skip this link.
            //   return
            // }
<span class="cstat-no" title="statement not covered" >            hrefs.push(link.href)</span>
          }
        })
<span class="cstat-no" title="statement not covered" >        return {</span>
          html: document.documentElement.outerHTML,
          hrefs
        }
      })
&nbsp;
      const htmlNetworkIdle = <span class="cstat-no" title="statement not covered" >evalNetworkIdle.html</span>
<span class="cstat-no" title="statement not covered" >      doms.push(cheerio.load(htmlNetworkIdle))</span>
<span class="cstat-no" title="statement not covered" >      evalNetworkIdle.hrefs.forEach(<span class="fstat-no" title="function not covered" >hr</span>ef =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        allHrefs.add(href)</span>
      })
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (!fulfilledPromise) <span class="cstat-no" title="statement not covered" >resolve()</span></span>
    } catch (e) {
      return safeReject(e)
    }
  })
&nbsp;
/**
 *
 * @param {{ urls: Array&lt;string&gt;, debug: boolean, loadimages: boolean, skippable: function, browser: any, userAgent: string, withoutjavascript: boolean, viewport: any }} options
 * @return Promise&lt;{ finalCss: string, stylesheetContents: { [key: string]: string } }&gt;
 */
const minimalcss = async options =&gt; {
  const { urls } = options
  const debug = options.debug || false
  // const keepPrintAtRules = options.keepPrintAtRules || false
  // XXX The launch options should be a parameter once this is no longer
  // just a cli app.
  const browser = options.browser || (<span class="branch-1 cbranch-no" title="branch not covered" >await puppeteer.launch({}))</span>
&nbsp;
  // All of these get mutated by the processPage() function. Once
  // per URL.
  const stylesheetAsts = {}
  const stylesheetContents = {}
  const doms = []
  const allHrefs = new Set()
  const redirectResponses = {}
  const skippedUrls = new Set()
&nbsp;
  try {
    // Note! This opens one URL at a time synchronous
    for (let i = 0; i &lt; urls.length; i++) {
      const pageUrl = urls[i]
      const page = await browser.newPage()
      try {
        await processPage({
          page,
          options,
          pageUrl,
          stylesheetAsts,
          stylesheetContents,
          doms,
          allHrefs,
          redirectResponses,
          skippedUrls
        })
      } catch (e) {
        throw e
      } finally {
        await page.close()
      }
    }
  } catch (e) {
    throw e
  } finally {
    // We can close the browser now that all URLs have been opened.
    <span class="missing-if-branch" title="if path not taken" >I</span>if (!options.browser) {
<span class="cstat-no" title="statement not covered" >      browser.close()</span>
    }
  }
&nbsp;
  // All URLs have been opened, and we now have multiple DOM objects.
&nbsp;
  // Now, let's loop over ALL links and process their ASTs compared to
  // the DOMs.
  const decisionsCache = <span class="cstat-no" title="statement not covered" >{}</span>
  const isSelectorMatchToAnyElement = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >se</span>lectorString =&gt; {</span>
    // Here's the crucial part. Decide whether to keep the selector
    // Find at least 1 DOM that contains an object that matches
    // this selector string.
<span class="cstat-no" title="statement not covered" >    return doms.some(<span class="fstat-no" title="function not covered" >do</span>m =&gt; {</span>
<span class="cstat-no" title="statement not covered" >      try {</span>
<span class="cstat-no" title="statement not covered" >        return dom(selectorString).length &gt; 0</span>
      } catch (ex) {
        // Be conservative. If we can't understand the selector,
        // best to leave it in.
<span class="cstat-no" title="statement not covered" >        if (debug) {</span>
<span class="cstat-no" title="statement not covered" >          console.warn(selectorString, ex.toString())</span>
        }
<span class="cstat-no" title="statement not covered" >        return true</span>
      }
    })
  }
<span class="cstat-no" title="statement not covered" >  allHrefs.forEach(<span class="fstat-no" title="function not covered" >hr</span>ef =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    while (redirectResponses[href]) {</span>
<span class="cstat-no" title="statement not covered" >      href = redirectResponses[href]</span>
    }
<span class="cstat-no" title="statement not covered" >    if (skippedUrls.has(href)) {</span>
<span class="cstat-no" title="statement not covered" >      return</span>
    }
    const ast = <span class="cstat-no" title="statement not covered" >stylesheetAsts[href]</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    csstree.walk(ast, {</span>
      visit: 'Rule',
      enter: <span class="fstat-no" title="function not covered" >fu</span>nction(node, item, list) {
<span class="cstat-no" title="statement not covered" >        if (</span>
          this.atrule &amp;&amp;
          csstree.keyword(this.atrule.name).basename === 'keyframes'
        ) {
          // Don't bother inspecting rules that are inside a keyframe.
<span class="cstat-no" title="statement not covered" >          return</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        node.prelude.children.forEach(<span class="fstat-no" title="function not covered" >(n</span>ode, item, list) =&gt; {</span>
          // Translate selector's AST to a string and filter pseudos from it
          // This changes things like `a.button:active` to `a.button`
          const selectorString = <span class="cstat-no" title="statement not covered" >utils.reduceCSSSelector(csstree.generate(node))</span>
<span class="cstat-no" title="statement not covered" >          if (selectorString in decisionsCache === false) {</span>
<span class="cstat-no" title="statement not covered" >            decisionsCache[selectorString] = isSelectorMatchToAnyElement(</span>
              selectorString
            )
          }
<span class="cstat-no" title="statement not covered" >          if (!decisionsCache[selectorString]) {</span>
            // delete selector from a list of selectors
<span class="cstat-no" title="statement not covered" >            list.remove(item)</span>
          }
        })
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (node.prelude.children.isEmpty()) {</span>
          // delete rule from a list
<span class="cstat-no" title="statement not covered" >          list.remove(item)</span>
        }
      }
    })
  })
  // Every unique URL in every &lt;link&gt; tag has been checked.
  const allCombinedAst = <span class="cstat-no" title="statement not covered" >{</span>
    type: 'StyleSheet',
    loc: null,
    children: Object.keys(stylesheetAsts).reduce(
<span class="fstat-no" title="function not covered" >      (c</span>hildren, href) =&gt; <span class="cstat-no" title="statement not covered" >children.appendList(stylesheetAsts[href].children),</span>
      new csstree.List()
    )
  }
&nbsp;
  // Lift important comments (i.e. /*! comment */) up to the beginning
  const comments = <span class="cstat-no" title="statement not covered" >new csstree.List()</span>
<span class="cstat-no" title="statement not covered" >  csstree.walk(allCombinedAst, {</span>
    visit: 'Comment',
    enter: <span class="fstat-no" title="function not covered" >(_</span>node, item, list) =&gt; {
<span class="cstat-no" title="statement not covered" >      comments.append(list.remove(item))</span>
    }
  })
<span class="cstat-no" title="statement not covered" >  allCombinedAst.children.prependList(comments)</span>
&nbsp;
  // Why not just allow the return of the "unminified" CSS (in case
  // some odd ball wants it)?
  // 'allCombinedAst' concatenates multiple payloads of CSS.
  // It only contains the selectors that are supposedly
  // in the DOM. However it does contain *duplicate* selectors.
  // E.g. `p { color: blue; } p { font-weight: bold; }`
  // When ultimately, what was need is `p { color: blue; font-weight: bold}`.
  // The csso.minify() function will solve this, *and* whitespace minify
  // it too.
<span class="cstat-no" title="statement not covered" >  csso.compress(allCombinedAst)</span>
<span class="cstat-no" title="statement not covered" >  postProcessOptimize(allCombinedAst)</span>
&nbsp;
  const returned = <span class="cstat-no" title="statement not covered" >{</span>
    finalCss: csstree.generate(allCombinedAst),
    stylesheetContents
  }
<span class="cstat-no" title="statement not covered" >  return Promise.resolve(returned)</span>
}
&nbsp;
module.exports = { run: minimalcss }
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="https://istanbul.js.org/" target="_blank">istanbul</a> at Fri Jan 26 2018 16:36:02 GMT-0500 (EST)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
